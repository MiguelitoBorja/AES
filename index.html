<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AES Cipher Studio - Cifrado Seguro Web</title>
  <link rel="stylesheet" href="aes.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
</head>
<body>
  <div class="container">
    <header class="main-header">
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-shield-alt"></i>
          <h1>AES Cipher Studio</h1>
        </div>
        <p class="subtitle">Cifrado AES-GCM seguro y f√°cil de usar en tu navegador</p>
      </div>
    </header>

    <nav class="nav-tabs">
      <button class="tab-btn active" data-tab="info"><i class="fas fa-info-circle"></i> Informaci√≥n</button>
      <button class="tab-btn" data-tab="text"><i class="fas fa-edit"></i> Cifrar Texto</button>
      <button class="tab-btn" data-tab="files"><i class="fas fa-file-image"></i> Cifrar Archivos</button>
      <button class="tab-btn" data-tab="security"><i class="fas fa-bug"></i> Pruebas de Seguridad</button>
    </nav>

    <div class="tab-content active" id="info-tab">
      <div class="card info-card">
        <div class="card-header">
          <h2><i class="fas fa-lock"></i> ¬øQu√© es AES?</h2>
        </div>
        <div class="card-body">
          <p><strong>AES (Advanced Encryption Standard)</strong> es el est√°ndar de cifrado m√°s seguro y utilizado mundialmente.</p>
          <div class="features-grid">
            <div class="feature">
              <i class="fas fa-key"></i>
              <h3>Cifrado Sim√©trico</h3>
              <p>Usa la misma clave para cifrar y descifrar datos</p>
            </div>
            <div class="feature">
              <i class="fas fa-cubes"></i>
              <h3>Cifrado por Bloques</h3>
              <p>Divide los datos en bloques de 128 bits</p>
            </div>
            <div class="feature">
              <i class="fas fa-shield-check"></i>
              <h3>Modo GCM</h3>
              <p>Garantiza autenticidad e integridad de los datos</p>
            </div>
          </div>
          
          <!-- Historia y Desarrollo de AES -->
          <div class="theory-section">
            <h3><i class="fas fa-history"></i> Historia y Desarrollo de AES</h3>
            <div class="timeline">
              <div class="timeline-item">
                <div class="timeline-marker">1997</div>
                <div class="timeline-content">
                  <h4>Convocatoria del NIST</h4>
                  <p>El Instituto Nacional de Est√°ndares y Tecnolog√≠a (NIST) de EE.UU. convoca un concurso p√∫blico para reemplazar el obsoleto DES.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">1998</div>
                <div class="timeline-content">
                  <h4>Rijndael - Los Creadores</h4>
                  <p><strong>Joan Daemen</strong> y <strong>Vincent Rijmen</strong> (cript√≥grafos belgas) presentan el algoritmo <strong>Rijndael</strong> como candidato.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">2001</div>
                <div class="timeline-content">
                  <h4>Rijndael se convierte en AES</h4>
                  <p>Tras rigurosas pruebas contra 14 candidatos, Rijndael es seleccionado y se convierte oficialmente en el <strong>Advanced Encryption Standard (AES)</strong>.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">2002</div>
                <div class="timeline-content">
                  <h4>Est√°ndar FIPS 197</h4>
                  <p>AES se publica como est√°ndar federal FIPS 197, convirti√©ndose en el algoritmo de cifrado sim√©trico m√°s utilizado mundialmente.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Estructura Interna del Algoritmo -->
          <div class="algorithm-section">
            <h3><i class="fas fa-cogs"></i> Estructura Interna del Algoritmo AES</h3>
            <div class="algorithm-details">
              <div class="algo-overview">
                <h4>üîß Caracter√≠sticas T√©cnicas</h4>
                <div class="specs-grid">
                  <div class="spec-item">
                    <span class="spec-label">Tama√±o de Bloque:</span>
                    <span class="spec-value">128 bits (16 bytes)</span>
                  </div>
                  <div class="spec-item">
                    <span class="spec-label">Tama√±os de Clave:</span>
                    <span class="spec-value">128, 192, 256 bits</span>
                  </div>
                  <div class="spec-item">
                    <span class="spec-label">N√∫mero de Rondas:</span>
                    <span class="spec-value">10, 12, 14 (seg√∫n tama√±o de clave)</span>
                  </div>
                  <div class="spec-item">
                    <span class="spec-label">Tipo:</span>
                    <span class="spec-value">Cifrado sim√©trico por bloques</span>
                  </div>
                </div>
              </div>

              <div class="operations-grid">
                <div class="operation-card">
                  <div class="op-header">
                    <i class="fas fa-exchange-alt"></i>
                    <h4>SubBytes</h4>
                  </div>
                  <p>Sustituci√≥n no lineal donde cada byte se reemplaza usando una tabla de sustituci√≥n (S-Box). Proporciona confusi√≥n criptogr√°fica.</p>
                  <div class="code-example">S-Box: 8 bits ‚Üí 8 bits</div>
                </div>

                <div class="operation-card">
                  <div class="op-header">
                    <i class="fas fa-arrows-alt"></i>
                    <h4>ShiftRows</h4>
                  </div>
                  <p>Permutaci√≥n c√≠clica de las filas de la matriz de estado. Cada fila se desplaza un n√∫mero diferente de posiciones.</p>
                  <div class="code-example">Fila 0: sin cambio<br>Fila 1: ‚Üê 1 pos<br>Fila 2: ‚Üê 2 pos<br>Fila 3: ‚Üê 3 pos</div>
                </div>

                <div class="operation-card">
                  <div class="op-header">
                    <i class="fas fa-project-diagram"></i>
                    <h4>MixColumns</h4>
                  </div>
                  <p>Transformaci√≥n lineal que opera en las columnas del estado. Cada columna se multiplica por una matriz fija en GF(2‚Å∏).</p>
                  <div class="code-example">Multiplicaci√≥n matricial en campo finito</div>
                </div>

                <div class="operation-card">
                  <div class="op-header">
                    <i class="fas fa-plus"></i>
                    <h4>AddRoundKey</h4>
                  </div>
                  <p>XOR bit a bit entre el estado actual y la subclave de la ronda correspondiente. Es la √∫nica operaci√≥n que involucra la clave.</p>
                  <div class="code-example">Estado ‚äï SubClave[ronda]</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Comparaci√≥n con Otros Algoritmos -->
          <div class="comparison-section">
            <h3><i class="fas fa-balance-scale"></i> Comparaci√≥n con Otros Algoritmos de Cifrado</h3>
            <div class="comparison-table">
              <table>
                <thead>
                  <tr>
                    <th>Algoritmo</th>
                    <th>Tama√±o de Clave</th>
                    <th>Tama√±o de Bloque</th>
                    <th>A√±o</th>
                    <th>Estado</th>
                    <th>Velocidad</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="current">
                    <td><strong>AES</strong></td>
                    <td>128/192/256 bits</td>
                    <td>128 bits</td>
                    <td>2001</td>
                    <td><span class="status secure">Seguro</span></td>
                    <td><span class="speed fast">Muy R√°pido</span></td>
                  </tr>
                  <tr>
                    <td>DES</td>
                    <td>56 bits</td>
                    <td>64 bits</td>
                    <td>1977</td>
                    <td><span class="status deprecated">Obsoleto</span></td>
                    <td><span class="speed medium">Medio</span></td>
                  </tr>
                  <tr>
                    <td>3DES</td>
                    <td>112/168 bits</td>
                    <td>64 bits</td>
                    <td>1998</td>
                    <td><span class="status deprecated">Obsoleto</span></td>
                    <td><span class="speed slow">Lento</span></td>
                  </tr>
                  <tr>
                    <td>Blowfish</td>
                    <td>32-448 bits</td>
                    <td>64 bits</td>
                    <td>1993</td>
                    <td><span class="status legacy">Legado</span></td>
                    <td><span class="speed fast">R√°pido</span></td>
                  </tr>
                  <tr>
                    <td>ChaCha20</td>
                    <td>256 bits</td>
                    <td>Stream cipher</td>
                    <td>2008</td>
                    <td><span class="status secure">Seguro</span></td>
                    <td><span class="speed fast">Muy R√°pido</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Casos de Uso y Aplicaciones -->
          <div class="applications-section">
            <h3><i class="fas fa-industry"></i> Casos de Uso y Aplicaciones en la Industria</h3>
            <div class="applications-grid">
              <div class="app-card">
                <div class="app-header">
                  <i class="fas fa-globe"></i>
                  <h4>Protocolos de Internet</h4>
                </div>
                <ul>
                  <li><strong>TLS/SSL:</strong> HTTPS, conexiones web seguras</li>
                  <li><strong>VPN:</strong> IPSec, OpenVPN, WireGuard</li>
                  <li><strong>SSH:</strong> Conexiones remotas seguras</li>
                  <li><strong>Signal Protocol:</strong> Mensajer√≠a cifrada</li>
                </ul>
              </div>

              <div class="app-card">
                <div class="app-header">
                  <i class="fas fa-hdd"></i>
                  <h4>Almacenamiento</h4>
                </div>
                <ul>
                  <li><strong>BitLocker:</strong> Cifrado de disco completo (Windows)</li>
                  <li><strong>FileVault:</strong> Cifrado de disco (macOS)</li>
                  <li><strong>LUKS:</strong> Cifrado de disco (Linux)</li>
                  <li><strong>Bases de datos:</strong> MySQL, PostgreSQL, Oracle</li>
                </ul>
              </div>

              <div class="app-card">
                <div class="app-header">
                  <i class="fas fa-mobile-alt"></i>
                  <h4>Dispositivos M√≥viles</h4>
                </div>
                <ul>
                  <li><strong>iOS:</strong> Cifrado del keychain y datos</li>
                  <li><strong>Android:</strong> Cifrado de almacenamiento interno</li>
                  <li><strong>WhatsApp:</strong> Cifrado end-to-end</li>
                  <li><strong>Signal:</strong> Mensajer√≠a privada</li>
                </ul>
              </div>

              <div class="app-card">
                <div class="app-header">
                  <i class="fas fa-university"></i>
                  <h4>Sector Gubernamental</h4>
                </div>
                <ul>
                  <li><strong>NSA:</strong> Clasificado para informaci√≥n TOP SECRET</li>
                  <li><strong>FIPS 140-2:</strong> Est√°ndar para m√≥dulos criptogr√°ficos</li>
                  <li><strong>Common Criteria:</strong> Evaluaci√≥n de seguridad</li>
                  <li><strong>Suite B:</strong> Algoritmos aprobados por NSA</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="mode-comparison">
            <h3>üîê Comparaci√≥n de Modos de Cifrado</h3>
            <div class="modes-grid">
              <div class="mode-card safe">
                <div class="mode-header">
                  <i class="fas fa-shield-alt"></i>
                  <h4>AES-GCM</h4>
                  <span class="badge safe">SEGURO</span>
                </div>
                <ul>
                  <li>‚úÖ Cifrado autenticado</li>
                  <li>‚úÖ Detecta modificaciones</li>
                  <li>‚úÖ Resistente a ataques</li>
                  <li>‚úÖ Usado en TLS/HTTPS</li>
                </ul>
              </div>
              
              <div class="mode-card educational">
                <div class="mode-header">
                  <i class="fas fa-graduation-cap"></i>
                  <h4>AES-CBC</h4>
                  <span class="badge educational">EDUCATIVO</span>
                </div>
                <ul>
                  <li>‚ö†Ô∏è Requiere IV √∫nico</li>
                  <li>‚ö†Ô∏è Vulnerable a padding oracle</li>
                  <li>‚ö†Ô∏è No detecta modificaciones</li>
                  <li>üìö √ötil para aprender</li>
                </ul>
              </div>
              
              <div class="mode-card dangerous">
                <div class="mode-header">
                  <i class="fas fa-exclamation-triangle"></i>
                  <h4>AES-ECB</h4>
                  <span class="badge dangerous">INSEGURO</span>
                </div>
                <ul>
                  <li>‚ùå Patrones visibles</li>
                  <li>‚ùå "Efecto Ping√ºino"</li>
                  <li>‚ùå Bloques id√©nticos = cifrado id√©ntico</li>
                  <li>üö´ NUNCA usar en producci√≥n</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Vulnerabilidades y Ataques Conocidos -->
          <div class="vulnerabilities-section">
            <h3><i class="fas fa-exclamation-triangle"></i> Vulnerabilidades y Ataques Conocidos</h3>
            <div class="vuln-disclaimer">
              <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                <strong>Nota Importante:</strong> AES sigue siendo considerado seguro cuando se implementa correctamente. Los ataques mencionados son principalmente te√≥ricos o requieren condiciones muy espec√≠ficas.
              </div>
            </div>

            <div class="attacks-grid">
              <div class="attack-card theoretical">
                <div class="attack-header">
                  <i class="fas fa-flask"></i>
                  <h4>Ataques Te√≥ricos</h4>
                  <span class="severity low">Severidad: Baja</span>
                </div>
                <div class="attack-content">
                  <div class="attack-item">
                    <h5>üìä Ataque Biclique (2011)</h5>
                    <p><strong>Complejidad:</strong> 2¬π¬≤‚Å∂ operaciones para AES-128</p>
                    <p><strong>Impacto:</strong> Mejora marginal sobre fuerza bruta (2¬π¬≤‚Å∏)</p>
                    <p><strong>Viabilidad:</strong> Completamente impracticable</p>
                  </div>
                  <div class="attack-item">
                    <h5>‚ö° Ataques de Canal Lateral</h5>
                    <p><strong>Tipo:</strong> An√°lisis de consumo de energ√≠a, tiempo de ejecuci√≥n</p>
                    <p><strong>Requisito:</strong> Acceso f√≠sico al dispositivo</p>
                    <p><strong>Mitigaci√≥n:</strong> Implementaciones resistentes a canales laterales</p>
                  </div>
                </div>
              </div>

              <div class="attack-card practical">
                <div class="attack-header">
                  <i class="fas fa-tools"></i>
                  <h4>Ataques de Implementaci√≥n</h4>
                  <span class="severity medium">Severidad: Media</span>
                </div>
                <div class="attack-content">
                  <div class="attack-item">
                    <h5>üîë Derivaci√≥n de Clave D√©bil</h5>
                    <p><strong>Problema:</strong> Usar contrase√±as directamente como claves</p>
                    <p><strong>Soluci√≥n:</strong> PBKDF2, Argon2, scrypt con alto costo</p>
                    <p><strong>En esta implementaci√≥n:</strong> ‚úÖ PBKDF2 con 200,000 iteraciones</p>
                  </div>
                  <div class="attack-item">
                    <h5>üîÑ Reutilizaci√≥n de IV/Nonce</h5>
                    <p><strong>Problema:</strong> Usar el mismo IV con la misma clave</p>
                    <p><strong>Impacto:</strong> P√©rdida de confidencialidad</p>
                    <p><strong>En esta implementaci√≥n:</strong> ‚úÖ IV aleatorio para cada operaci√≥n</p>
                  </div>
                </div>
              </div>

              <div class="attack-card critical">
                <div class="attack-header">
                  <i class="fas fa-skull-crossbones"></i>
                  <h4>Errores de Implementaci√≥n Cr√≠ticos</h4>
                  <span class="severity high">Severidad: Alta</span>
                </div>
                <div class="attack-content">
                  <div class="attack-item">
                    <h5>üìã Modo ECB (Electronic Code Book)</h5>
                    <p><strong>Problema:</strong> Bloques id√©nticos ‚Üí cifrado id√©ntico</p>
                    <p><strong>Demostraci√≥n:</strong> Ver secci√≥n "Efecto Ping√ºino" abajo</p>
                    <p><strong>Estado:</strong> ‚ùå NUNCA usar en producci√≥n</p>
                  </div>
                  <div class="attack-item">
                    <h5>üîê Padding Oracle Attack</h5>
                    <p><strong>Afecta:</strong> Principalmente modo CBC mal implementado</p>
                    <p><strong>Mitigaci√≥n:</strong> Usar modos autenticados (GCM)</p>
                    <p><strong>En esta implementaci√≥n:</strong> ‚úÖ GCM recomendado por defecto</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="security-recommendations">
              <h4><i class="fas fa-shield-check"></i> Recomendaciones de Seguridad</h4>
              <div class="recommendations-grid">
                <div class="rec-item">
                  <i class="fas fa-check-circle"></i>
                  <div>
                    <strong>Usar AES-256-GCM</strong>
                    <p>Modo autenticado que proporciona confidencialidad e integridad</p>
                  </div>
                </div>
                <div class="rec-item">
                  <i class="fas fa-check-circle"></i>
                  <div>
                    <strong>Derivaci√≥n robusta de claves</strong>
                    <p>PBKDF2 con m√≠nimo 100,000 iteraciones, preferible Argon2</p>
                  </div>
                </div>
                <div class="rec-item">
                  <i class="fas fa-check-circle"></i>
                  <div>
                    <strong>IVs/Nonces √∫nicos</strong>
                    <p>Generar aleatoriamente para cada operaci√≥n de cifrado</p>
                  </div>
                </div>
                <div class="rec-item">
                  <i class="fas fa-check-circle"></i>
                  <div>
                    <strong>Gesti√≥n segura de claves</strong>
                    <p>No almacenar claves en texto plano, usar HSMs cuando sea posible</p>
                  </div>
                </div>
                <div class="rec-item">
                  <i class="fas fa-check-circle"></i>
                  <div>
                    <strong>Implementaciones probadas</strong>
                    <p>Usar librer√≠as criptogr√°ficas establecidas y auditadas</p>
                  </div>
                </div>
                <div class="rec-item">
                  <i class="fas fa-check-circle"></i>
                  <div>
                    <strong>Rotaci√≥n de claves</strong>
                    <p>Establecer pol√≠ticas de renovaci√≥n peri√≥dica de claves</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Rendimiento y Benchmarks -->
          <div class="performance-section">
            <h3><i class="fas fa-tachometer-alt"></i> Rendimiento y An√°lisis de Eficiencia</h3>
            <div class="performance-content">
              <div class="benchmark-grid">
                <div class="benchmark-card">
                  <div class="benchmark-header">
                    <i class="fas fa-microchip"></i>
                    <h4>Hardware Moderno</h4>
                  </div>
                  <div class="benchmark-stats">
                    <div class="stat-item">
                      <span class="stat-label">CPU con AES-NI:</span>
                      <span class="stat-value">~1-2 GB/s</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">CPU sin AES-NI:</span>
                      <span class="stat-value">~100-200 MB/s</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Memoria requerida:</span>
                      <span class="stat-value">~1-2 KB</span>
                    </div>
                  </div>
                </div>

                <div class="benchmark-card">
                  <div class="benchmark-header">
                    <i class="fas fa-mobile-alt"></i>
                    <h4>Dispositivos M√≥viles</h4>
                  </div>
                  <div class="benchmark-stats">
                    <div class="stat-item">
                      <span class="stat-label">ARM moderno:</span>
                      <span class="stat-value">~50-100 MB/s</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Consumo energ√©tico:</span>
                      <span class="stat-value">Muy bajo</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Latencia:</span>
                      <span class="stat-value">&lt;1ms para texto</span>
                    </div>
                  </div>
                </div>

                <div class="benchmark-card">
                  <div class="benchmark-header">
                    <i class="fas fa-globe"></i>
                    <h4>Navegadores Web</h4>
                  </div>
                  <div class="benchmark-stats">
                    <div class="stat-item">
                      <span class="stat-label">Web Crypto API:</span>
                      <span class="stat-value">~10-50 MB/s</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">JavaScript puro:</span>
                      <span class="stat-value">~1-5 MB/s</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Esta implementaci√≥n:</span>
                      <span class="stat-value">Web Crypto API</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="performance-notes">
                <h4><i class="fas fa-lightbulb"></i> Factores de Rendimiento</h4>
                <ul>
                  <li><strong>AES-NI:</strong> Instrucciones espec√≠ficas de Intel/AMD que aceleran AES hasta 10x</li>
                  <li><strong>Tama√±o de clave:</strong> AES-256 es ~40% m√°s lento que AES-128</li>
                  <li><strong>Modo de operaci√≥n:</strong> GCM a√±ade ~20-30% de overhead por autenticaci√≥n</li>
                  <li><strong>Derivaci√≥n de clave:</strong> PBKDF2 con 200,000 iteraciones toma ~100-500ms</li>
                  <li><strong>Paralelizaci√≥n:</strong> Los modos CTR y GCM permiten procesamiento paralelo</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="text-tab">
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-edit"></i> Cifrado de Texto</h2>
        </div>
        <div class="card-body">
          <div class="text-section">
            <div class="input-group">
              <label for="textPlain"><i class="fas fa-file-alt"></i> Texto Plano</label>
              <textarea id="textPlain" placeholder="Escribe tu mensaje secreto aqu√≠..." rows="6"></textarea>
            </div>
            
            <div class="password-section">
              <div class="input-group">
                <label for="pwdText"><i class="fas fa-key"></i> Contrase√±a</label>
                <div class="password-input">
                  <input id="pwdText" type="password" placeholder="Ingresa una contrase√±a segura" />
                  <button type="button" class="toggle-password" data-target="pwdText">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
                <div class="password-strength">
                  <div class="strength-bar">
                    <div class="strength-fill"></div>
                  </div>
                  <span class="strength-text">Fuerza de contrase√±a</span>
                </div>
              </div>
              
              <div class="input-group">
                <label for="textMode"><i class="fas fa-cogs"></i> Modo de Cifrado</label>
                <select id="textMode" class="mode-select">
                  <option value="GCM">AES-GCM (Recomendado - Seguro)</option>
                  <option value="CBC">AES-CBC (Educativo)</option>
                  <option value="ECB">AES-ECB (Inseguro - Solo demostraci√≥n)</option>
                </select>
              </div>
              
              <div class="button-group">
                <button id="btnEncryptText" class="btn btn-primary">
                  <i class="fas fa-lock"></i> Cifrar
                </button>
                <button id="btnDecryptText" class="btn btn-secondary">
                  <i class="fas fa-unlock"></i> Descifrar
                </button>
                <button id="btnCopyResult" class="btn btn-copy" style="display:none">
                  <i class="fas fa-copy"></i> Copiar
                </button>
              </div>
            </div>
            
            <div class="input-group">
              <label for="textCipher"><i class="fas fa-code"></i> Texto Cifrado (Base64)</label>
              <textarea id="textCipher" placeholder="El resultado cifrado aparecer√° aqu√≠..." rows="6"></textarea>
            </div>
          </div>
          
          <!-- Secci√≥n de Proceso Detallado -->
          <div class="process-details" id="processDetails" style="display: none;">
            <div class="process-header">
              <h3><i class="fas fa-cogs"></i> Proceso de Cifrado Paso a Paso</h3>
              <p>Observa c√≥mo se realiza el cifrado AES internamente</p>
            </div>
            
            <div class="process-steps">
              <div class="step-card" id="step1">
                <div class="step-header">
                  <div class="step-number">1</div>
                  <h4><i class="fas fa-random"></i> Generaci√≥n de Salt</h4>
                </div>
                <div class="step-content">
                  <p>Se genera un salt aleatorio de 16 bytes para la derivaci√≥n de clave:</p>
                  <div class="code-block">
                    <code id="saltValue">Esperando cifrado...</code>
                  </div>
                </div>
              </div>

              <div class="step-card" id="step2">
                <div class="step-header">
                  <div class="step-number">2</div>
                  <h4><i class="fas fa-key"></i> Derivaci√≥n de Clave (PBKDF2)</h4>
                </div>
                <div class="step-content">
                  <p>Se deriva una clave AES-256 usando PBKDF2 con SHA-256:</p>
                  <div class="process-info">
                    <div class="info-row">
                      <span class="label">Contrase√±a:</span>
                      <span class="value" id="passwordInfo">***</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Salt:</span>
                      <span class="value" id="saltInfo">-</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Iteraciones:</span>
                      <span class="value">200,000</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Hash:</span>
                      <span class="value">SHA-256</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Longitud de clave:</span>
                      <span class="value">256 bits</span>
                    </div>
                  </div>
                  <div class="code-block">
                    <code id="keyValue">Clave derivada aparecer√° aqu√≠...</code>
                  </div>
                </div>
              </div>

              <div class="step-card" id="step3">
                <div class="step-header">
                  <div class="step-number">3</div>
                  <h4><i class="fas fa-dice"></i> Generaci√≥n de IV/Nonce</h4>
                </div>
                <div class="step-content">
                  <p id="ivDescription">Se genera un vector de inicializaci√≥n aleatorio:</p>
                  <div class="process-info">
                    <div class="info-row">
                      <span class="label">Longitud:</span>
                      <span class="value" id="ivLength">-</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Prop√≥sito:</span>
                      <span class="value" id="ivPurpose">-</span>
                    </div>
                  </div>
                  <div class="code-block">
                    <code id="ivValue">IV aparecer√° aqu√≠...</code>
                  </div>
                </div>
              </div>

              <div class="step-card" id="step4">
                <div class="step-header">
                  <div class="step-number">4</div>
                  <h4><i class="fas fa-shield-alt"></i> Proceso de Cifrado</h4>
                </div>
                <div class="step-content">
                  <p>Se cifra el texto usando el algoritmo AES:</p>
                  <div class="process-info">
                    <div class="info-row">
                      <span class="label">Algoritmo:</span>
                      <span class="value" id="algorithmInfo">-</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Modo:</span>
                      <span class="value" id="modeInfo">-</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Tama√±o de bloque:</span>
                      <span class="value">128 bits (16 bytes)</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Texto original:</span>
                      <span class="value" id="originalTextInfo">-</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Bytes de entrada:</span>
                      <span class="value" id="inputBytesInfo">-</span>
                    </div>
                  </div>
                  <div class="code-block">
                    <code id="cipherValue">Texto cifrado aparecer√° aqu√≠...</code>
                  </div>
                </div>
              </div>

              <div class="step-card" id="step5">
                <div class="step-header">
                  <div class="step-number">5</div>
                  <h4><i class="fas fa-archive"></i> Formato Final</h4>
                </div>
                <div class="step-content">
                  <p>Se concatenan todos los componentes y se codifican en Base64:</p>
                  <div class="process-info">
                    <div class="info-row">
                      <span class="label">Estructura:</span>
                      <span class="value" id="structureInfo">-</span>
                    </div>
                    <div class="info-row">
                      <span class="label">Tama√±o total:</span>
                      <span class="value" id="totalSizeInfo">-</span>
                    </div>
                  </div>
                  <div class="code-block">
                    <code id="finalValue">Resultado final aparecer√° aqu√≠...</code>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="files-tab">
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-file-image"></i> Cifrado de Archivos</h2>
        </div>
        <div class="card-body">
          <div class="files-section">
            <div class="encrypt-section">
              <h3><i class="fas fa-upload"></i> Cifrar Archivo</h3>
              <div class="file-drop-zone" id="encryptDropZone">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Arrastra un archivo aqu√≠ o haz clic para seleccionar</p>
                <input id="fileEncrypt" type="file" style="display: none;" />
              </div>
              <div class="file-info" id="encryptFileInfo" style="display: none;"></div>
              
              <div class="input-group">
                <label for="pwdEncrypt"><i class="fas fa-key"></i> Contrase√±a</label>
                <div class="password-input">
                  <input id="pwdEncrypt" type="password" placeholder="Contrase√±a para cifrar" />
                  <button type="button" class="toggle-password" data-target="pwdEncrypt">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>
              
              <div class="input-group">
                <label for="fileMode"><i class="fas fa-cogs"></i> Modo de Cifrado</label>
                <select id="fileMode" class="mode-select">
                  <option value="GCM">AES-GCM (Recomendado - Seguro)</option>
                  <option value="CBC">AES-CBC (Educativo)</option>
                  <option value="ECB">AES-ECB (Inseguro - Efecto Ping√ºino)</option>
                </select>
              </div>
              
              <button id="btnEncrypt" class="btn btn-primary full-width">
                <i class="fas fa-lock"></i> Cifrar y Descargar
              </button>
            </div>
            
            <div class="decrypt-section">
              <h3><i class="fas fa-download"></i> Descifrar Archivo</h3>
              <div class="file-drop-zone" id="decryptDropZone">
                <i class="fas fa-file-code"></i>
                <p>Arrastra un archivo .aes aqu√≠</p>
                <input id="fileDecrypt" type="file" accept=".aes" style="display: none;" />
              </div>
              <div class="file-info" id="decryptFileInfo" style="display: none;"></div>
              
              <div class="input-group">
                <label for="pwdDecrypt"><i class="fas fa-key"></i> Contrase√±a</label>
                <div class="password-input">
                  <input id="pwdDecrypt" type="password" placeholder="Contrase√±a para descifrar" />
                  <button type="button" class="toggle-password" data-target="pwdDecrypt">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>
              
              <div class="input-group">
                <label><i class="fas fa-info-circle"></i> Usar el mismo modo que para cifrar</label>
              </div>
              
              <button id="btnDecrypt" class="btn btn-secondary full-width">
                <i class="fas fa-unlock"></i> Descifrar
              </button>
              <div id="saveDownload"></div>
            </div>
          </div>
          
          <div class="preview-section">
            <div class="preview-container">
              <h4>Vista Previa - Original</h4>
              <div id="previewAreaOriginal" class="preview-area"></div>
            </div>
            <div class="preview-container">
              <h4>Vista Previa - Descifrado</h4>
              <div id="previewAreaDecrypted" class="preview-area"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="security-tab">
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-bug"></i> Pruebas de Seguridad</h2>
        </div>
        <div class="card-body">
          <div class="security-tests">
            <div class="test-section">
              <h3><i class="fas fa-exclamation-triangle"></i> Prueba 1: Contrase√±a Incorrecta</h3>
              <p>Intenta descifrar texto o archivos con una contrase√±a incorrecta. El sistema detectar√° el error y no mostrar√° datos basura.</p>
              <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                <strong>Tip:</strong> Prueba cifrar algo y luego descifrarlo con una contrase√±a diferente.
              </div>
            </div>
            
            <div class="test-section">
              <h3><i class="fas fa-clock"></i> Prueba 2: Costo Computacional (PBKDF2)</h3>
              <p>Las contrase√±as se procesan usando PBKDF2 con <strong>200,000 iteraciones</strong> para hacer los ataques de fuerza bruta extremadamente lentos.</p>
              <button id="btnIterationsTest" class="btn btn-warning">
                <i class="fas fa-stopwatch"></i> Probar Derivaci√≥n de Clave
              </button>
              <div id="iterationResults" class="test-results" style="display: none;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="status-section">
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-terminal"></i> Estado del Sistema</h2>
        </div>
        <div class="card-body">
          <div id="log" class="log-container">
            <div class="log-entry">
              <i class="fas fa-info-circle"></i>
              <span>Sistema listo. Selecciona una operaci√≥n para comenzar.</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Secci√≥n de Demostraci√≥n Visual del "Efecto Ping√ºino" -->
    <section class="visual-demo-section">
      <div class="demo-header">
        <h2><i class="fas fa-eye"></i> Demostraci√≥n Visual: "Efecto Ping√ºino"</h2>
        <p>Compara la diferencia visual entre cifrado seguro (GCM/CBC) e inseguro (ECB) en im√°genes</p>
      </div>

      <div class="demo-controls">
        <div class="control-group">
          <label for="demoImageInput"><i class="fas fa-image"></i> Seleccionar Imagen</label>
          <input type="file" id="demoImageInput" accept="image/*" />
        </div>
        <div class="control-group">
          <label for="demoPassword"><i class="fas fa-key"></i> Contrase√±a</label>
          <div class="password-input">
            <input type="password" id="demoPassword" value="demo123" placeholder="Contrase√±a para demo" />
            <button type="button" class="toggle-password" data-target="demoPassword" title="Mostrar contrase√±a">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>
        <button id="runVisualDemo" class="demo-button">
          <i class="fas fa-play"></i> Ejecutar Demostraci√≥n
        </button>
      </div>

      <div id="demoStatus" class="demo-status"></div>

      <div class="canvas-container">
        <div class="canvas-card">
          <h3><i class="fas fa-image"></i> Imagen Original</h3>
          <canvas id="canvasOriginal"></canvas>
          <p>Tu imagen tal como se ve normalmente</p>
        </div>
        
        <div class="canvas-card danger">
          <h3><i class="fas fa-exclamation-triangle"></i> ECB (Inseguro)</h3>
          <canvas id="canvasECB"></canvas>
          <p>¬°Se puede ver la silueta! Patrones repetitivos son visibles</p>
        </div>
        
        <div class="canvas-card safe">
          <h3><i class="fas fa-shield-alt"></i> GCM (Seguro)</h3>
          <canvas id="canvasGCM"></canvas>
          <p>Ruido total - imposible distinguir la imagen original</p>
        </div>
      </div>

      <div class="demo-explanation">
        <h3><i class="fas fa-info-circle"></i> ¬øPor qu√© sucede esto?</h3>
        <div class="explanation-grid">
          <div class="explanation-card">
            <h4><i class="fas fa-times-circle"></i> ECB (Electronic Code Book)</h4>
            <ul>
              <li>Cifra cada bloque de 16 bytes por separado</li>
              <li>Bloques id√©nticos ‚Üí cifrado id√©ntico</li>
              <li>Preserva patrones visuales</li>
              <li><strong>¬°Nunca uses ECB para im√°genes!</strong></li>
            </ul>
          </div>
          <div class="explanation-card">
            <h4><i class="fas fa-check-circle"></i> GCM/CBC (Modos Seguros)</h4>
            <ul>
              <li>Usa vectores de inicializaci√≥n (IV)</li>
              <li>Cada bloque depende del anterior</li>
              <li>Bloques id√©nticos ‚Üí cifrado diferente</li>
              <li><strong>Resultado: ruido completamente aleatorio</strong></li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <footer class="main-footer">
      <p><i class="fas fa-shield-alt"></i> Cifrado AES-GCM con 256 bits de seguridad</p>
      <p>Todos los procesos se ejecutan localmente en tu navegador</p>
    </footer>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner">
      <i class="fas fa-sync-alt fa-spin"></i>
      <p>Procesando...</p>
    </div>
  </div>






<script src="aes.js"></script>
</body>
</html>